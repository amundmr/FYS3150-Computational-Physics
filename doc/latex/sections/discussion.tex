\documentclass[../main.tex]{subfiles}
\begin{document}
\section{Discussion}\label{sec:discussion}

\subsection{Euler and Verlet without object orientation}
Comparing The Verlet and Eulers method, as seen in figure \ref{fig:EarthOrbit_Euler_Verlet}, both methods work just fine. However, we can see that we have a larger error in the Euler method than the Verlet method, since the orbit of Earth in the Euler plot is expanding faster.

%oppgave 5c)
\subsection{Testing}
As we can se from section \ref{sec:results-test-timestep}, the Verlet method is quite stable. Even with a step length of $0.02$ years, we see that the orbit for the first thousand years is still quite good. However, with larger steplengths, the calculations soon become unreliable. \\
From results \ref{sec:results-test-conservation} we see that both the kinetic and potential energy is constant over time, thus it is conserved. Since these values are constant, the angular momentum must also be constant, since it only depends on distance, speed and mass. \\
When comparing the performance between the Euler and Verlet algorithm in results section \ref{sec:Verlet_VS_Euler} it is not clear which is the best. This is because of all the other things going on in our program. For example we illustrated that saving the file to disk is what is both the biggest uncertainty, and the biggest time taker. This is because the write speed is dependent on how much the rest of the system wants to access the hard drive. Due to this uncertainty, the Euler method - running with writing to disk - actually took longer than the same Verlet run. We also see without filesave, that the time saved by the Euler algorithm is not substantial, and not worth the loss of accuracy. For this reason, the velocity Verlet algorithm is used in the rest of this project.

%oppgave 5d)
\subsection{Escape velocity}
As shown in section \ref{sec:results-esc-vel}, the escape velocity found by trial and error on the initial conditions resulted in an incredibly good value compared to our analytical expression. This is yet another proof that our code is solid. \\
When modifying the exponent of the distance in the force formula, we get the expected result in figure \ref{fig:v_esc_beta}. When $\beta$ increases we would expect all objects with orbit radius greater than $1AU$ to feel a weaker force, which the trajectories in the mentioned figure clearly shows.

\subsection{Three-body problem.}
We see in figure \ref{fig:SunEarthJupiter10fixed} that after adding Jupiter, Earth's orbit is not altered much. Even with Jupiter ten times its mass, the orbit is virtually unchanged. However, increasing Jupiter's mass close to the suns mass, we see that Earths orbit gets unstable, and slingshots out of the system after around 5 years.
We also found that the fixed Sun approximation is quite good. This can be seen from figure \ref{fig:SunEarthJupiter10}, where we see that for its original mass, Jupiter does not distort the orbits in any impactful way. However we see that when Jupiter becomes 10 times its mass, the sun starts to change position, which in turns affect the Earths orbit also. We also plotted the scenario when Jupiter and the Sun has approximately the same mass, where all three bodies are free to move. This resulted in the beautiful plot in figure \ref{fig:SunEarthJupiter1000}, where we can see the Sun and Jupiter beautifully dancing around each other while the Earth violently moves between the two strong gravitational fields.

\subsection{The Solar system}
In figure \ref{fig:allPlanets} we see the solar system with all its planets orbiting beautifully over a period of 150 years. As we can see, Neptune still has 15 years to complete a full orbit, while most other planets has already completed several orbits. As a matter of fact, Mercury has completed a staggering 622 full orbits. \\
It is important to note that in the plot, the planet's sizes are obviously not to scale. However, the orbit sizes are to scale, and that lets us visually see why Neptune takes such a long time to complete an orbit, while Mercury is so quick.
%Above is an alternative solar system discussion..
\iffalse
When making a simulation of the different planets in our Solar system, it would be strange if we did not look at the whole system together. The orbit of all the planets in The Solar system is plotted in figure \ref{fig:allPlanets}. As expected(studied in real life) they all move around the Sun in a somewhat circular/elliptical orbit during our simulation.
\fi

\subsection{The perihelion precession of Mercury}
In order to test the general theory of relativity, we found the perihelion precession of Mercury with and without the relative correction. We found or non-corrected force to result in zero perihelion precession, which is expected, and we found the corrected force to result in a value very close to the observed perihelion precession. This means that our calculations, and the general theory of relativity holds true for this scenario, which means that the perihelion precession of Mercury can indeed be explained by the general theory of relativity.

\end{document}
