\documentclass[../main.tex]{subfiles}
\begin{document}
\section{Results} \label{sec:results}
\subsection{Gauss-Legendre} \label{sec:QMProbresults}

Solving our integral with Legandre polynomials gives unstable results for $N \in [-5,5]$ as seen in the table below. Though with a carefull choise of N = 27 and integration limits a = -2.9 and b = 2.9 our results are precice with 4 leading digits after the decimal point.

\begin{table}[h!]
\begin{center}
  \begin{tabular}{ |p{1cm}|p{4cm}|p{3cm}|}
 \hline
 \multicolumn{3}{|c|}{\textbf{Legendre}} \\
 \hline
       N   &Approximate integral & Error\\
 \hline
 11 & 0.297447 & 0.104681\\
 15 & 0.315863 & 0.123098\\
 21 & 0.268075 & 0.075310\\
 25 & 0.240135 & 0.047370\\
 27 & 0.229623 & 0.036858\\
 27*& 0.192725 & 0.000039\\
 \hline
 \end{tabular}
 \caption{Values of the integral for different N's, calculated with Gauss-Legendre. Integration limits are $x\in[-5,5]$. *: Special case with integration limits $x\in[-2.9,2.9]$}
 \end{center}
\end{table}

\subsection{Gauss-Laguerre} \label{sec:QMProbresults}
Improving our algorithm using Legandre polynomials for angles and Laguerre polynomials for radial parts improved accuracy and stability of our results. An increase in $N \in [-5,5]$ from N = 11 to N = 15 also gives an increase in precistion, tough for and higer increase the accuracy decrese slightly, which is shown in Table 2.

\begin{table}[h!]
\begin{center}
\begin{tabular}{ |p{1cm}|p{4cm}|p{3cm}|}
 \hline
 \multicolumn{3}{|c|}{\textbf{Laguerre}} \\
 \hline
       N   & Approximate integral & Error\\
 \hline
 11 &  0.183021 &  0.009743\\
 15 &  0.193285 &  0.000520\\
 21 &  0.194807 &  0.002050\\
 25 &  0.194804 &  0.002030\\
 27 &  0.194795 &  0.002029\\

 \hline
\end{tabular}
\caption{Values of the integral for different N's, calculated with Gauss-Laguerre. Integration limits are $x\in[-5,5]$.}
\end{center}
\end{table}

\FloatBarrier

%------------------------
\subsection{Monte Carlo}
\subsubsection{Naïve approach}
The results from our Monte Carlo integration program (\href{https://github.com/kmaasrud/Project-3/blob/master/code/Monte-Carlo/main.exe}{main.exe}), are listed in this table:

\begin{table}[h!]
  \begin{center}
    \begin{tabular}{|p{1cm}|p{3.5cm}|p{3cm}|p{3cm}|}
     \hline
     \multicolumn{4}{|c|}{\textbf{Naïve Monte Carlo}} \\
     \hline
           N   & Approximate integral & Standard deviation & Error\\
     \hline
     $10^5$ &  0.21953065 &  0.154683 & 0.026764935\\
     $10^6$ &  0.14149215 &  0.0368397 & 0.051273556\\
     $10^7$ &  0.16704012 &  0.023165 & 0.025725592\\
     $10^8$ &  0.17903453 &  0.00936631 & 0.013731177\\
     $10^9$ &  0.19105511 &  0.0041004 & 0.0017106036\\
    
     \hline
    \end{tabular}
    \caption{Results from running Monte Carlo with cartesian coordinates and integration limits $x\in[-5,5]$ - our approximation of infinity.}
  \end{center}
\end{table}

For higher $N$'s, the approximated integral get closer to the actual value and the standard deviation decreases. The error ($|\text{Exact}-\text{Approximated}|$) does however not match up with the standard deviation, and oscillates a bit up and down, despite having a trend of decreasing.

%------------------------------------
\subsubsection{Importance sampling}
The results from our Monte Carlo integration program (\href{https://github.com/kmaasrud/Project-3/blob/master/code/Monte-Carlo/main.exe}{main.exe}), are listed in this table:

\begin{table}[h!]
  \begin{center}
    \begin{tabular}{|p{1cm}|p{3.5cm}|p{3cm}|p{3cm}|}
      \hline
      \multicolumn{4}{|c|}{\textbf{Improved Monte Carlo}} \\
      \hline
      N   & Approximate integral & Standard deviation & Error\\
      \hline
      $10^5$ &  0.13773907 &  0.284624 & 0.055026645\\
      $10^6$ &  0.19068327 &  0.405372 & 0.0020824368\\
      $10^7$ &  0.2075781 &  0.381901  & 0.014812393\\
      $10^8$ &  0.19459392 &  0.092418  & 0.001828214\\
      $10^9$ &  0.20918288 &  0.0646068 & 0.016417166\\
      \hline
    \end{tabular}
    \caption{Results from running Monte Carlo with importance sampling along the exponential distribution and using spherical coordinates.}
  \end{center}
\end{table}

The improved Monte Carlo integration gets within a small error margin for smaller $N$'s than the naïve, However, it over- and undershoots randomly. The trend is that the standard deviation decreases, but does not match up with the error ($|\text{Exact}-\text{Approximated}|$).

\subsection{Paralellization} \label{sec:res-paralell}
Our paralellization results was achieved using a quad core Intel Core i5-8250U processor with 6MB cache at 1.6GHz base clock, which boosted to 3.4GHz during testing. Thermal throttling was avoided.
The memory was 4GB 1866MHz LPDDR3 soldered on board. See table \ref{tab:res-paralell}

We also ran this test on an octa-core processor with memory of 8GB 1866MHz, and achieved no noticable speedup compared to the abovementioned computer. See table \ref{tab:res-paralell-octacore}

$\vspace{0.1cm}$

For runtime imputs the number of samples was set to $10^8$, with an approximation of infity of $\lambda = 5$.
\begin{table}[!h]
  \begin{center}
    \begin{tabular}{|p{2.5cm}|p{2.5cm}|p{1cm}|p{1.7cm}|p{2.8cm}|}
      \hline
      \multicolumn{5}{|c|}{\textbf{Runtime with different optimizations}} \\
      \hline
      Compile flags & -O3 -fopenMP & -O3 & -fopenmp & No optimization \\
      \hline
      Naive MC & 12s & 31s & 71s & 173s \\
      Improved MC & 15s & 38s & 79s & 200s \\
      \hline
    \end{tabular}
    \caption{Shows the time spent on the same calculations with different compile parameters on a quad core processor.($N = 10^8, \lambda = 5$)}
    \label{tab:res-paralell}
  \end{center}
\end{table}

\begin{table}[!h]
\begin{center}
  \begin{tabular}{|p{2.5cm}|p{2.5cm}|}
    \hline
    \multicolumn{2}{|c|}{\textbf{Runtime with optimization on octa-core}} \\
    \hline
    Compile flags & -O3 -fopenMP \\
    \hline
    Naive MC & 12s \\
    Improved MC & 15s \\
    \hline
  \end{tabular}
  \caption{Shows the time spent on the Monte-Carlo calculations on an octa-core system.($N = 10^8, \lambda = 5$)}
  \label{tab:res-paralell-octacore}
  \end{center}
\end{table}


\end{document}
